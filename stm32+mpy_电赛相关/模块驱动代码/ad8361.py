from pyb import Pin

def get_table(num_8361):
        if num_8361 == 2:
                acvoltage = [0.010,0.011,0.012,0.013,0.014,0.015,0.016,0.017,0.018,0.019,0.020,
                        0.025,0.030,0.035,0.040,0.045,0.050,0.055,0.060,0.065,0.070,0.075,0.080,0.085,0.090,0.100,
                        0.1,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.2,
                        0.25,0.3,0.35,0.4,0.45,0.5,
                        0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2.0,
                        2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3]
                dcvoltage = [0.018,0.020,0.021,0.022,0.024,0.026,0.028,0.030,0.031,0.033,0.035,
                        0.044,0.052,0.060,0.068,0.076,0.084,0.092,0.1,0.108,0.116,0.124,0.132,0.139,0.147,0.154,0.162,
                        0.176,0.193,0.208,0.223,0.238,0.254,0.269,0.284,0.299,0.315,
                        0.386,0.461,0.533,0.605,0.676,0.746,
                        0.889,1.025,1.163,1.301,1.441,1.582,1.723,1.858,1.994,2.13,2.28,2.43,2.58,2.73,2.88,
                        3.03,3.19,3.35,3.50,3.65,3.82,3.98,4.13,4.29,4.45,4.6,4.7,4.77]
        elif num_8361 == 3:
                acvoltage = [0.036,0.037,0.038,0.039,0.040,0.041,0.042,0.043,0.044,0.045,0.046,0.047,0.048,0.049,0.050,
                        0.055,0.060,0.065,0.070,0.075,0.080,0.085,0.090,0.095,0.100,
                        0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.2,
                        0.25,0.3,0.35,0.4,0.45,0.5,0.55,0.6,0.65,0.7,0.75,0.8,0.85,0.9,0.95,1,
                        1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3]
                dcvoltage = [0.014,0.015,0.019,0.023,0.027,0.032,0.035,0.038,0.041,0.045,0.048,0.050,0.053,0.055,0.058,
                        0.069,0.079,0.089,0.099,0.109,0.118,0.126,0.134,0.143,0.151,
                        0.168,0.185,0.201,0.217,0.233,0.249,0.265,0.281,0.296,0.313,
                        0.386,0.463,0.537,0.610,0.683,0.753,0.829,0.899,0.969,1.039,1.106,1.177,1.246,1.317,1.387,1.457,
                        1.599,1.742,1.877,1.89,2.15,2.26,2.41,2.49,2.55,2.62,3.02,3.17,3.34,3.51,3.67,3.84,4,4.15,4.31,4.47,4.64,4.73,4.75]
        return acvoltage, dcvoltage

def map2V(num_8361,dcvoltage):
        acvoltage_table, dcvoltage_table = get_table(num_8361)
        if dcvoltage < dcvoltage_table[0]:
                acvoltage = acvoltage_table[0]
        elif dcvoltage >= dcvoltage_table[-1]:
                acvoltage = acvoltage_table[-1]
        else:
                for i in range(len(dcvoltage_table)-1):
                        if dcvoltage >= dcvoltage_table[i] and dcvoltage < dcvoltage_table[i+1]:
                                ratio = (dcvoltage - dcvoltage_table[i])/(dcvoltage_table[i+1]-dcvoltage_table[i])
                                acvoltage = acvoltage_table[i] + ratio*(acvoltage_table[i+1]-acvoltage_table[i])
        return acvoltage

